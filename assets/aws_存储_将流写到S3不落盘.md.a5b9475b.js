import{_ as s,c as n,o as a,a as l}from"./app.58320140.js";const _=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"aws/存储/将流写到S3不落盘.md"}'),p={name:"aws/存储/将流写到S3不落盘.md"},o=l(`<p>将流写到S3不落盘</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> boto3</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> io </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> BytesIO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">s3_client </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> boto3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">client</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">s3</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">region_name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cn-north-1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">response </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> s3_client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get_object</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">Bucket</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">buckert_name</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#A6ACCD;font-style:italic;">Key</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a.csv</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">file_content </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> response</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Body</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">].</span><span style="color:#82AAFF;">read</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 假设文件内容是UTF-8编码的文本</span></span>
<span class="line"><span style="color:#A6ACCD;">text_content </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> file_content</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">decode</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">text_content</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 你可以在这里对文本进行操作，如果需要的话</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 将文本重新编码为字节</span></span>
<span class="line"><span style="color:#A6ACCD;">byte_content </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> text_content</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">encode</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">byte_content</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 使用BytesIO对象将字节内容上传到S3</span></span>
<span class="line"><span style="color:#A6ACCD;">s3_client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">upload_fileobj</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">BytesIO</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">byte_content</span><span style="color:#89DDFF;">),</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">buckert_name</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">my-key.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">File uploaded successfully</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div>`,2),t=[o];function e(c,F,D,r,y,i){return a(),n("div",null,t)}const C=s(p,[["render",e]]);export{_ as __pageData,C as default};
